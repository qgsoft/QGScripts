(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["appuamn"],{c536:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("AuraHeadTitle",{attrs:{title:"修改昵称","left-url":"/u/account"}}),n("div",{staticClass:"m-box"},[n("div",{staticClass:"m-box-items m-box-items-full"},[n("UserModifyNameInput",{attrs:{name:t.newName},on:{"update:name":function(e){t.newName=e}}})],1)]),n("div",{staticClass:"m-box"},[n("AuraFullButton",{attrs:{title:"保存","btn-class":"m-account-modify"},on:{click:t.confirm}})],1),n("AuraFooter"),n("UserAccountTip",{attrs:{content:t.content,type:t.type,"delay-time":t.delayTime,toggle:t.tipShow},on:{"update:toggle":function(e){t.tipShow=e}}}),n("AuraPopup",{directives:[{name:"show",rawName:"v-show",value:t.showPopup,expression:"showPopup"}],attrs:{info:"是否保存修改的昵称?","left-button-text":"不保存","right-button-text":"保存"},on:{leftButtonClick:t.cancel,rightButtonClick:t.confirm}})],1)},a=[],s=(n("96cf"),n("3b8d")),r=n("73d5"),o=n("59c3"),u=n("fd12"),c=n("49ce"),p=n("b2e7"),h=n("fe3a"),m=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"m-account-modify"},[n("div",{staticClass:"input-wrap"},[n("input",{staticClass:"modify_nicName",attrs:{placeholder:t.defaultName,type:"text"},domProps:{value:t.inputName},on:{input:t.onInput}})]),n("div",t._l(t.errors,function(e){return n("p",{key:e.id,staticClass:"warn-tips"},[n("i",{staticClass:"warn-icon"}),t._v(t._s(e.msg)+"\n    ")])}),0)])},l=[],f=(n("4f37"),n("7f7f"),{name:"UserModifyNameInput",props:{name:{type:String,default:""}},data:function(){return{errors:[],inputName:this.name,defaultName:this.name}},mounted:function(){this.validateString(this.inputName)},methods:{onInput:function(t){this.inputName=t.target.value,this.validateString(this.inputName)},validateString:function(t){var e=this.validateUserName(t);this.$emit("update:name",e?t:this.defaultName)},validateUserName:function(t){this.errors=[];var e=Object(p["t"])(t);return!0!==e&&(this.errors=this.errors.concat(e)),t.trim()===this.defaultName&&this.errors.push({name:"sameName",msg:"新用户名不能和旧用户名相同"}),!this.errors.length}}}),d=f,w=n("2877"),v=Object(w["a"])(d,m,l,!1,null,null,null),b=v.exports,N={name:"UserModifyName",components:{AuraHeadTitle:r["a"],AuraFullButton:o["a"],AuraPopup:u["a"],UserAccountTip:c["a"],UserModifyNameInput:b},mixins:[h["a"]],style:["base","user"],title:"修改昵称-爱奇艺",data:function(){return{type:"none",content:"",delayTime:2e3,tipShow:!1,newName:this.$store.state.userInfo.userinfo.nickname,showPopup:!1}},computed:{userinfo:function(){return this.$store.state.userInfo.userinfo},nickname:function(){return this.userinfo.nickname}},watch:{nickname:function(t){this.newName=t}},asyncData:function(t){var e=t.store;return e.dispatch("getUserInfo")},beforeRouteLeave:function(t,e,n){this.nickname!==this.newName?this.showPopup=!0:n()},methods:{confirm:function(){var t=Object(s["a"])(regeneratorRuntime.mark(function t(e){var n,i,a=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(this.showPopup=!1,this.newName!==this.nickname){t.next=3;break}return t.abrupt("return");case 3:return t.prev=3,t.next=6,Object(p["X"])();case 6:if(n=t.sent,"A00000"===n.code){t.next=9;break}return t.abrupt("return",this.showTip(n.msg,"oneline"));case 9:return t.next=11,Object(p["W"])({nickname:this.newName});case 11:if(i=t.sent,"A00000"===i.code){t.next=14;break}return t.abrupt("return",this.showTip(i.msg,"oneline"));case 14:this.showTip("保存成功","complete"),this.$store.dispatch("getUserInfo",{refresh:!0}).then(function(){a.$router.push({path:"/u/account/"})}),t.next=21;break;case 18:t.prev=18,t.t0=t["catch"](3),this.showTip("哎呀，出错了，请稍后再试","oneline");case 21:case"end":return t.stop()}},t,this,[[3,18]])}));function e(e){return t.apply(this,arguments)}return e}(),showTip:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"loading",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2e3;this.content=t,this.type=e,this.delayTime=n,this.tipShow=!0},cancel:function(){this.showPopup=!1,this.newName=this.nickname,this.$router.push({path:"/u/account/"})}}},g=N,y=Object(w["a"])(g,i,a,!1,null,null,null);e["default"]=y.exports}}]);