(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["apptl"],{"31ca":function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{ref:"banner",staticClass:"m-newExpress-banner",style:"background-image:url("+t.image+")"}),i("TimelineNavigator",{ref:"nav",attrs:{"selected-day":t.selectedDay,fixed:t.fixed},on:{changeDay:t.clickChangeDay}}),i("TimelineList")],1)},s=[],a=(i("28a5"),i("20d6"),i("ac6a"),i("f3e2"),i("cebc")),r=i("2f62"),o=i("fe3a"),c=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"m-time-tab-wrap"},[i("TimelineScroll",{class:["m-time-tab",{"po-fixed-share":t.fixed,"m-time-tab-vip":t.isVip}],attrs:{"list-length":t.listLength,"current-index":t.currentIndex},on:{scrollLeftIndex:t.setCurrentMonth,scrollMove:function(e){t.isTouchmove=!0}}},[i("div",{staticStyle:{float:"left"}},[i("div",{staticClass:"title"},t._l(t.dates,function(e,n){return i("span",{key:n,class:[{current:0===n},{next:0!==n},{hide:t.currentMonth===e.month&&!t.isTouchmove}],style:"left:"+e.left+"rem"},[t._v("\n          "+t._s(t._f("formatMonth")(e.month))+"月\n        ")])}),0),i("div",{staticClass:"m-tab-num m-sliding"},[i("ul",{staticClass:"list-items m-sliding-list"},[t._l(t.dateList,function(e,n){return i("li",{directives:[{name:"pingback",rawName:"v-pingback",value:"170310_yuyue_tab"+n,expression:"`170310_yuyue_tab${index}`"}],key:n,staticClass:"c-tab-item",class:{selected:t.currentIndex===n},attrs:{"item-id":n},on:{click:function(i){return t.onChangeDay(e)}}},[t._v("\n            "+t._s(e.day)+"\n          ")])}),t.isPublish?t._e():i("li",{directives:[{name:"pingback",rawName:"v-pingback",value:"170310_yuyue_tab"+t.days.length,expression:"`170310_yuyue_tab${days.length}`"}],staticClass:"c-tab-item",class:{selected:t.currentIndex===t.days.length},on:{click:function(e){return t.selectDay("敬请期待")}}},[t._v("敬请期待")])],2)])]),i("div",{class:["current-month",{hide:t.isTouchmove}]},[t._v(t._s(t._f("formatMonth")(t.currentMonth||t.dates[0].month))+"月")])])],1)},u=[],l=(i("57e7"),i("6d67"),i("0cd8"),i("a481"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{ref:"root",staticStyle:{overflow:"hidden"}},[t._t("default")],2)}),d=[],h=(i("c5f6"),i("1fba")),f={name:"Scroll",props:{listLength:{type:Number,default:0},probeType:{type:Number,default:1},click:{type:Boolean,default:!0},scrollX:{type:Boolean,default:!0},content:{type:String,default:""},currentIndex:{type:Number,default:0}},data:function(){return{scroll:"",itemWidth:0,contentWidth:0,bodyWidth:0,root:null,halfContentWidth:0}},watch:{currentIndex:function(){var t=this.root.querySelector('[item-id="'.concat(this.currentIndex,'"]'));if(t){this.scroll.scrollToElement(t,0,!0,!0);var e=Math.ceil(-this.scroll.x/this.itemWidth);this.$emit("scrollLeftIndex",e)}}},mounted:function(){var t=this;this.$nextTick(function(){t.root=t.$refs.root,t.scroll=new h["a"](t.root,{probeType:t.probeType,scrollX:t.scrollX,resize:!0,eventPassthrough:"vertical",HWCompositing:!1,useTransition:!1});var e=t.root.children[0];t.contentWidth=e.clientWidth,t.halfContentWidth=t.contentWidth/2,t.itemWidth=Math.abs(t.contentWidth)/t.listLength,t.bodyWidth=document.body.clientWidth,t.root.addEventListener("touchmove",t.onTouchMove)})},destroyed:function(){this.scroll.destroy(),this.root.removeEventListener("touchmove",this.onTouchMove)},methods:{onTouchMove:function(){this.$emit("scrollMove")}}},m=f,p=i("2877"),v=Object(p["a"])(m,l,d,!1,null,null,null),b=v.exports,y=i("4f30"),g={name:"TimelineNavigator",components:{TimelineScroll:b},filters:{formatMonth:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return t.replace(/\b(0+)/gi,"")}},props:{selectedDay:{type:String,default:""},fixed:{type:Boolean,default:!1}},data:function(){return{currentIndex:0,currentMonth:"",isTouchmove:!1}},computed:Object(a["a"])({},Object(r["e"])("timeline",{videos:"videos",isPublish:"isPublish",channelId:"channelId",days:"days",dates:function(t){var e=t.dates,i=void 0===e?[]:e;return i.forEach(function(t,e){for(var n=0,s=1;s<=e;s++)n+=.42*i[s-1].days.length;t.left=n}),i},listLength:function(t){var e=t.days,i=void 0===e?[]:e,n=t.isPublish;return i.length+(n?0:1)}}),{isVip:function(){return String(this.channelId)===y["CHANNEL_VIP"]},dateList:function(){return this.dates.reduce(function(t,e){var i=e.days||[];return t.concat(i.map(function(t){return{year:e.year,month:e.month,day:t}}))},[])}}),watch:{selectedDay:function(){var t=this,e="敬请期待"===this.selectedDay?this.days.length:this.dateList.findIndex(function(e){return t.selectedDay==="".concat(e.year,"-").concat(e.month,"-").concat(e.day)});this.currentIndex=-1===e?0:e}},methods:{onChangeDay:function(t){this.currentIndex=this.dateList.indexOf(t);var e="".concat(t.year,"-").concat(t.month,"-").concat(t.day);this.selectDay(e)},selectDay:function(t){this.$emit("changeDay",t)},setCurrentMonth:function(t){var e=this.dateList[t]||{};this.currentMonth=e.month,this.isTouchmove=!1}}},_=g,x=Object(p["a"])(_,c,u,!1,null,null,null),w=x.exports,T=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[t._l(t.videos,function(e,n){return i("div",{directives:[{name:"pingback",rawName:"v-pingback",value:"170310_yuyue_video"+n,expression:"`170310_yuyue_video${index}`"}],key:n,class:["m-newExpress-list",{"m-newExpress-list-vip":t.isVip},"list-group"],attrs:{id:e.day,"data-group":"list-group"}},[i("div",{staticClass:"title"},[i("i",{staticClass:"c-newExpress-icon c-icon-time"}),t._v("\n      "+t._s(e.showTime)+"\n    ")]),t._l(e.list,function(e,n){return i("div",{key:n,staticClass:"item"},[i("a",{staticClass:"c-link",on:{click:function(i){return t.link(i,e,(e.isTrailer||!e.pubStr)&&e.pageUrl)}}},[i("div",{staticClass:"img",style:{"background-image":"url("+e.imageUrl+")"}},[i("div",{staticClass:"c-rt"},[e.upperRightCorner||e.payMarkUrl?i("AuraVideoPicicon",{attrs:{text:e.upperRightCorner,"pay-mark-url":e.payMarkUrl}}):t._e()],1),e.isTrailer||!e.pubStr?i("div",{staticClass:"c-rb"},[i("span",{staticClass:"c-date"},[i("i",{staticClass:"score-item"},[t._v(t._s(e.playTime))])])]):t._e()]),i("div",{staticClass:"info"},[i("div",{staticClass:"name"},[t._v(t._s(e.name))]),i("div",{staticClass:"tag"},t._l(e.tags,function(e,n){return i("span",{key:n,staticClass:"c-tag"},[t._v(t._s(e))])}),0),i("div",{staticClass:"des"},[t._v(t._s(e.focus))]),e.isTrailer||!e.pubStr?i("div",{staticClass:"count"},[i("span",{staticClass:"c-num"},[t._v(t._s(t._f("formatNum")(e.subscribeCount)))]),t._v(t._s(e.subStaus)+"\n          ")]):t._e()])]),e.pageUrl&&e.isTrailer||!e.pubStr?i("a",{directives:[{name:"pingback",rawName:"v-pingback",value:"170310_yuyue_yuyue"+n,expression:"`170310_yuyue_yuyue${index}`"}],key:"sub",staticClass:"newExpress-btn",class:{selected:e.subscribeStatus},on:{click:function(i){return t.observe(i,e)}}},[i("i",{staticClass:"c-newExpress-icon c-icon-yuyue"}),t._v(" "+t._s(e.subscribeStatus?"已预约":"预约")+"\n      ")]):t._e(),!e.isTrailer&&e.pageUrl&&e.pubStr?i("a",{directives:[{name:"pingback",rawName:"v-pingback",value:"170310_yuyue_video"+n,expression:"`170310_yuyue_video${index}`"}],key:"detail",staticClass:"newExpress-btn",attrs:{href:e.pageUrl,title:e.mainTitle||e.title||e.subTitle||""}},[t._v("查看详情")]):t._e()])})],2)}),i("AuraPopup",{directives:[{name:"show",rawName:"v-show",value:t.isObervePopShow,expression:"isObervePopShow"}],attrs:{title:t.toastText,"right-button-text":"去下载","left-button-text":"取消"},on:{leftButtonClick:function(e){t.isObervePopShow=!1},rightButtonClick:t.callApp}}),i("AuraToast",{directives:[{name:"show",rawName:"v-show",value:t.isToastShow,expression:"isToastShow"}],attrs:{text:t.toastText}})],2)},k=[],C=i("5176"),S=i.n(C),O=(i("96cf"),i("3b8d")),I=i("fd12"),N=i("6f18"),j=i("b2e7"),E=i("8296"),L=i("ba45"),P=i("45bc"),A=i("5321"),D={name:"TimelineList",components:{AuraPopup:I["a"]},filters:{formatNum:P["c"]},data:function(){return{isObervePopShow:!1,isToastShow:!1,toastText:"",subtype:154}},computed:Object(a["a"])({},Object(r["e"])("timeline",{videos:"videos",channelId:"channelId"}),{isVip:function(){return String(this.channelId)===y["CHANNEL_VIP"]}}),methods:{observe:function(t,e){E["i"].weixin||E["i"].qqApp?Object(j["M"])()?this.subscribe(e):this.toHref("/user.html?redirect_url=".concat(encodeURIComponent(location.href))):this.callTimeline(t)},link:function(t,e,i){var n=this;!i||E["i"].weixin||E["i"].qqApp||E["G"].ios&&E["i"].baidubox?this.toHref(e.pageUrl):(this.callAppPlay(t,e),setTimeout(function(){n.toHref(e.pageUrl)},1e3))},toHref:function(t){t&&(window.location.href=t)},subscribe:function(){var t=Object(O["a"])(regeneratorRuntime.mark(function t(e){var i,n;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(N["f"])({subKeys:e.qipuId,isSubed:e.subscribeStatus});case 3:i=t.sent,i&&i.success?(e.subscribeStatus=!e.subscribeStatus,n=e.subscribeStatus?"预约成功<br>下载爱奇艺APP观看影片":"取消预约",this.toast(e.subscribeStatus,n)):this.toast(!1,"由于网络问题，请稍后重试"),t.next=9;break;case 7:t.prev=7,t.t0=t["catch"](0);case 9:case"end":return t.stop()}},t,this,[[0,7]])}));function e(e){return t.apply(this,arguments)}return e}(),toast:function(t,e){var i=this;this.toastText=e,this.isObervePopShow=t,t||(this.isToastShow=!0,setTimeout(function(){i.isToastShow=!1},2e3))},callTimeline:function(t){var e=this;Object(L["A"])({cid:this.channelId}).catch(function(){Object(L["k"])(Object(L["m"])()),e.sendDownPingback(t.target)})},callApp:function(t){var e=this;Object(L["s"])({query:S()(Object(L["n"])(),{ftype:27,subtype:this.subtype})}).catch(function(){Object(L["k"])(Object(L["m"])()),e.sendDownPingback(t.target)})},callAppPlay:function(t,e){var i=this;Object(L["y"])({tvid:e.qipuId}).catch(function(){Object(L["k"])(Object(L["m"])()),i.sendDownPingback(t.target)})},sendDownPingback:function(t){Object(A["g"])({rt:{A:"a",IMG:"i"}[t.nodeName]||"e",rseat:"170310_yuyue_download",rlink:t.getAttribute("href"),packgtype:E["G"].android?"androidphone":"iphone"})}}},M=D,H=Object(p["a"])(M,T,k,!1,null,null,null),$=H.exports,W=(i("759f"),i("936f")),q=i("11ad"),U={vip:y["CHANNEL_VIP"],weidianying:y["CHANNEL_WEIDIANYING"],dianying:y["CHANNEL_DIANYING"],qyhomeyuyue:y["CHANNEL_HOME"]};function V(t,e){return R.apply(this,arguments)}function R(){return R=Object(O["a"])(regeneratorRuntime.mark(function t(e,i){var n,s,a;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return n=e.commit,s=U[i],t.next=4,W["a"].jsonp("".concat(q["u"]),{params:{channelId:s},headers:{Cookie:this.$cookies.cookie}});case 4:return a=t.sent,n("setTimeline",a&&a.data.data),t.abrupt("return",a.data);case 7:case"end":return t.stop()}},t,this)})),R.apply(this,arguments)}function B(t,e){if(e){var i=e.videos||[];t.isPublish=!J(i),t.videos=t.videos.concat(X(Y(i))),t.dates=G(i),t.days=F(i),t.channelId=e.config.channelId,t.image=e.config.imageUrl,t.title=e.config.shortTitle}}function F(t){var e=[];return t.forEach(function(t){e=e.concat(t.days)}),e}function G(t){var e=[];return t.forEach(function(t){var i=t.month.split("-");t.days.length&&i&&e.push({year:i[0],month:i[1],days:t.days})}),e}function Y(t){var e=[],i=[];return t.forEach(function(t){t.videoList.forEach(function(t){if(t.subStaus=t.subscribeStatus?"已预约":"预约",t.tags=t.showContent.split(" ").slice(0,2),t.subscribeCount=t.subscribeCount<11e3?11e3:t.subscribeCount,t.pubStr)t.showTime=t.pubStr,t.day=t.pubStr,e.push(t);else{var n=t.pubTime.split(" ");t.day=n[0],t.showTime="".concat(t.showTime," ").concat(n[1]),i.push(t)}})}),i.concat(e)}function X(t){var e=[];return t.reduce(function(t,e){var i=e.showTime;return t.length&&t.some(function(t){return t&&t.showTime===i})?t.forEach(function(t){t&&t.showTime===i&&t.list.push(e)}):t.push({day:e.day,showTime:i,list:[e]}),t},e)}function J(t){return t.some(function(t){return t.videoList.some(function(t){return!!t.pubStr})})}var z={namespaced:!0,state:function(){return{videos:[],isPublish:!0,days:[],dates:[],channelId:"",image:"",title:""}},actions:{getTimeline:V},mutations:{setTimeline:B}},K=i("4e77"),Q={name:"Timeline",components:{TimelineNavigator:w,TimelineList:$},mixins:[o["a"]],style:["base","timeline"],title:function(){return this.title||"爱奇艺新片速递"},asyncData:function(t){t.res;var e=t.store,i=t.route,n=i.params.source;e.registerModule("timeline",z,{preserveState:e.state.timeline});var s=e.state.timeline.videos;if(!s||!s.length)return e.dispatch("timeline/getTimeline",n)},data:function(){return{selectedDay:"",fixed:!1,bannerHeight:0,navHeight:0,videoNodeList:[]}},computed:Object(r["e"])("timeline",["videos","title","image"]),mounted:function(){Object(K["e"])(this.onScroll),Object(K["e"])(this.setFixed),Object(K["c"])(this.setFixed),this.init()},destroyed:function(){this.$store.unregisterModule("timeline"),Object(K["h"])(this.onScroll),Object(K["h"])(this.setFixed),Object(K["f"])(this.setFixed)},methods:Object(a["a"])({},Object(r["b"])("timeline",["getTimeline"]),{onScroll:function(t){var e=this;this.scrollY=t.scrollOffset.y,this.videoNodeList.forEach(function(t,i){var n=t.offsetTop-e.scrollY-e.navHeight;(n<=0||n>0&&n<=e.bannerHeight&&0===i)&&(e.selectedDay=t.id)})},clickChangeDay:function(t){Object(E["N"])(document.querySelectorAll("[id='".concat(t,"']"))[0],this.navHeight)},getShowIndex:function(t){var e=this.videos.findIndex(function(e,i){var n=e.pubTime.split(" ")[0];return n===t});return e>-1?e:0},init:function(){var t=this.$refs;this.bannerHeight=t.banner.offsetHeight,this.navHeight=t.nav.$el.offsetHeight,this.videoNodeList=document.querySelectorAll('[data-group="list-group"]')},setFixed:function(t){var e=90===window.orientation||-90===window.orientation;this.fixed=!e&&t.scrollOffset.y>=this.bannerHeight}})},Z=Q,tt=Object(p["a"])(Z,n,s,!1,null,null,null);e["default"]=tt.exports}}]);